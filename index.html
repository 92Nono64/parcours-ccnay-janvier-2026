<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programme Club 2026</title>

    <style>
        /* === STYLE G√âN√âRAL === */
        body { font-family: 'Segoe UI', sans-serif; background: #eef2f3; margin: 0; padding: 15px 10px; color: #333; }
        .container { max-width: 600px; margin: 0 auto; }

        header { text-align: center; margin-bottom: 15px; }
        .logo-img { max-height: 90px; display: block; margin: 0 auto 5px auto; }
        h1 { color: #2c3e50; margin: 0; font-size: 1.6rem; text-transform: uppercase; }

        /* === MENU COMPACT === */
        .tabs-wrapper {
            background: #fff; padding: 12px 5px; border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-bottom: 20px; text-align: center;
        }
        .tabs-row { display: flex; flex-wrap: wrap; justify-content: center; gap: 6px; margin-bottom: 6px; }
        .tabs-row:last-child { margin-bottom: 0; }
        .tab-btn {
            padding: 6px 0; width: 15%; min-width: 45px;
            border: 1px solid #eee; background: #f8f9fa;
            font-weight: 700; font-size: 0.75rem; color: #555;
            cursor: pointer; border-radius: 15px; text-transform: uppercase; transition: 0.2s;
        }
        .tab-btn:hover { background: #e2e6ea; }
        .tab-btn.active { background: #cc0000; color: white; border-color: #cc0000; box-shadow: 0 2px 4px rgba(204, 0, 0, 0.3); }

        /* M√âT√âO */
        .weather-card {
            background: linear-gradient(to bottom, #fff, #f9f9f9);
            border: 1px solid #ccc; border-radius: 8px; padding: 10px; margin-bottom: 25px;
            text-align: center; display: flex; align-items: center; justify-content: center; gap: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* BORNE STYLE */
        .borne-card {
            background-color: #fdfdfd; border: 1px solid #aaa;
            border-radius: 40px 40px 8px 8px; box-shadow: 4px 4px 0px rgba(0,0,0,0.2);
            margin-bottom: 30px; overflow: hidden; animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .borne-header {
            background-color: #cc0000; color: white;
            padding: 15px 10px 10px 10px; text-align: center;
            font-weight: 900; font-size: 1.1rem; text-transform: uppercase;
            border-bottom: 4px solid #990000;
        }
        .horaires-bandeau {
            background: #2c3e50; color: #fff; text-align: center;
            padding: 6px; font-size: 0.8rem; font-weight: bold; text-transform: uppercase;
        }

        /* BOUTON CARTE COMMUN */
        .map-section { padding: 12px; background: #f4f4f4; border-bottom: 1px solid #ddd; text-align: center; }
        .btn-map-large {
            display: block; width: 100%; padding: 10px 0; border-radius: 6px; 
            background: white; color: #333; border: 2px solid #555;
            text-decoration: none; font-weight: 800; font-size: 0.9rem; 
            cursor: pointer; transition: 0.2s;
        }
        .btn-map-large:active { transform: scale(0.98); background: #eee; }

        /* LIGNES CIRCUITS */
        .circuit-row { padding: 12px 15px; border-bottom: 1px solid #eee; display: flex; flex-direction: column; gap: 8px; }
        .circuit-row:last-child { border-bottom: none; }
        
        .tag { font-size: 0.7rem; font-weight: 900; color: white; padding: 3px 6px; border-radius: 4px; text-transform: uppercase; display: inline-block; margin-bottom: 4px; }
        .tag-t1 { background: #cc0000; } .tag-t2 { background: #2980b9; }

        .nom-parcours { font-size: 1rem; font-weight: 800; color: #222; margin-bottom: 2px; }
        .infos-line { display: flex; justify-content: space-between; align-items: baseline; }
        .lieux { font-size: 0.8rem; color: #555; font-style: italic; border-left: 3px solid #ddd; padding-left: 8px; margin-top: 4px; display: block; }
        .deniv { font-size: 0.85rem; color: #d35400; font-weight: bold; }

        /* BOUTONS GPX INDIVIDUELS */
        .btn-gpx { 
            text-align: center; padding: 8px 0; border-radius: 6px; 
            text-decoration: none; font-weight: bold; font-size: 0.85rem; 
            color: white; border: none; cursor: pointer; display: block;
            transition: background 0.2s; text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        .btn-gpx-t1 { background-color: #29b6f6; } 
        .btn-gpx-t1:hover { background-color: #039be5; }
        .btn-gpx-t2 { background-color: #66bb6a; }
        .btn-gpx-t2:hover { background-color: #43a047; }

        /* POPUP CARTE */
        #map-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; flex-direction: column; align-items: center; justify-content: center; }
        #modal-frame { width: 95%; height: 80vh; border: 4px solid white; border-radius: 5px; background: white; }
        #close-btn { background: white; border: none; padding: 12px 30px; border-radius: 50px; font-weight: bold; font-size: 1rem; margin-top: 20px; cursor: pointer; }
        .empty-msg { text-align: center; padding: 30px; color: #888; font-style: italic; background: white; border-radius: 10px; font-size: 0.9rem;}
        
        #error-log { color: red; text-align: center; font-weight: bold; padding: 10px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <img src="files/logo.png" alt="Logo" class="logo-img" onerror="this.style.display='none'">
        <h1>Sorties Club</h1>
    </header>

    <div class="tabs-wrapper">
        <div class="tabs-row">
            <button class="tab-btn" onclick="chargerMois('janvier')" id="btn-janvier">Jan</button>
            <button class="tab-btn" onclick="chargerMois('fevrier')" id="btn-fevrier">F√©v</button>
            <button class="tab-btn active" onclick="chargerMois('mars')" id="btn-mars">Mar</button>
            <button class="tab-btn" onclick="chargerMois('avril')" id="btn-avril">Avr</button>
            <button class="tab-btn" onclick="chargerMois('mai')" id="btn-mai">Mai</button>
            <button class="tab-btn" onclick="chargerMois('juin')" id="btn-juin">Juin</button>
        </div>
        <div class="tabs-row">
            <button class="tab-btn" onclick="chargerMois('juillet')" id="btn-juillet">Juil</button>
            <button class="tab-btn" onclick="chargerMois('aout')" id="btn-aout">Ao√ªt</button>
            <button class="tab-btn" onclick="chargerMois('septembre')" id="btn-septembre">Sep</button>
            <button class="tab-btn" onclick="chargerMois('octobre')" id="btn-octobre">Oct</button>
            <button class="tab-btn" onclick="chargerMois('novembre')" id="btn-novembre">Nov</button>
            <button class="tab-btn" onclick="chargerMois('decembre')" id="btn-decembre">D√©c</button>
        </div>
    </div>

    <div class="weather-card">
        <span style="font-size:2rem;">‚è≥</span>
        <div>
            <span style="font-size:0.75rem; font-weight:bold; color:#888; text-transform:uppercase;">M√©t√©o √† Nay</span>
            <div id="w-text" style="font-size:1.1rem; font-weight:bold;">Recherche...</div>
        </div>
    </div>

    <div id="error-log"></div>

    <div id="liste-parcours"></div>
</div>

<div id="map-modal">
    <iframe id="modal-frame" src="" frameborder="0"></iframe>
    <button id="close-btn" onclick="closeMap()">FERMER</button>
</div>

<script>
try {
    // =================================================================
    // CONFIGURATION DES PARCOURS
    // =================================================================
    const programmeAnnuel = {
        
        janvier: [
            {
                weekend: "Samedi 04 & Dimanche 05 Jan",
                idCarteVisu: "LX6m39axGx", 
                t1: { nom: "La Vall√©e Verte", km: "90 km", dplus: "D+ 800m", lieux: "Nay > Lestelle > Lourdes", lienGPX: "https://www.visugpx.com/download.php?id=LX6m39axGx" },
                t2: { nom: "Petit Tour", km: "70 km", dplus: "D+ 500m", lieux: "Nay > Coarraze > B√©n√©jacq", lienGPX: "https://www.visugpx.com/download.php?id=LX6m39axGx" }
            },
            {
                weekend: "Samedi 11 & Dimanche 12 Jan",
                idCarteVisu: "DZdNBb98zZ", 
                t1: { nom: "Col du Soulor", km: "105 km", dplus: "D+ 1200m", lieux: "Nay > Arthez > Soulor", lienGPX: "https://www.visugpx.com/download.php?id=DZdNBb98zZ" },
                t2: { nom: "Vall√©e de l'Ouzom", km: "80 km", dplus: "D+ 600m", lieux: "Nay > Ferri√®res", lienGPX: "https://www.visugpx.com/download.php?id=DZdNBb98zZ" }
            }
        ],

        fevrier: [
            {
                weekend: "Samedi 07 & Dimanche 08 F√©v",
                idCarteVisu: "LX6m39axGx",
                t1: { nom: "Parcours #098", km: "67 km", dplus: "D+ 550m", lieux: "Nay, Mirepeix, Sendets, Ouillon...", lienGPX: "https://www.visugpx.com/download.php?id=LX6m39axGx" },
                t2: { nom: "Parcours #098", km: "61 km", dplus: "D+ 450m", lieux: "Nay, Espoey, Lagos, B√©n√©jacq...", lienGPX: "https://www.visugpx.com/download.php?id=LX6m39axGx" }
            },
            {
                weekend: "Samedi 14 & Dimanche 15 F√©v",
                idCarteVisu: "DZdNBb98zZ",
                t1: { nom: "Parcours #012", km: "65 km", dplus: "D+ 600m", lieux: "Nay, Gelos, Laroin, Aubertin...", lienGPX: "https://www.visugpx.com/download.php?id=DZdNBb98zZ" },
                t2: { nom: "Parcours #012", km: "55 km", dplus: "D+ 500m", lieux: "Nay, Gelos, Gan et retour commun", lienGPX: "https://www.visugpx.com/download.php?id=DZdNBb98zZ" }
            },
            {
                weekend: "Samedi 21 & Dimanche 22 F√©v",
                idCarteVisu: "SBK0EGKdcJ",
                t1: { nom: "Parcours #042", km: "75 km", dplus: "D+ 650m", lieux: "Nay, Montaut, Pontacq, Ger...", lienGPX: "https://www.visugpx.com/download.php?id=SBK0EGKdcJ" },
                t2: { nom: "Parcours #042", km: "68 km", dplus: "D+ 550m", lieux: "Aast, Gard√®res, Eslourenties...", lienGPX: "https://www.visugpx.com/download.php?id=SBK0EGKdcJ" }
            },
            {
                weekend: "Samedi 28 F√©v & Dimanche 01 Mar",
                idCarteVisu: "GRw87MTBC8",
                t1: { nom: "Parcours #016", km: "74 km", dplus: "D+ 800m", lieux: "Nay, Asson, Bruges, Louvie...", lienGPX: "https://www.visugpx.com/download.php?id=GRw87MTBC8" },
                t2: { nom: "Parcours #016", km: "64 km", dplus: "D+ 600m", lieux: "Igon, Coarraze, Nay...", lienGPX: "https://www.visugpx.com/download.php?id=GRw87MTBC8" }
            }
        ],

        // === MOIS DE MARS : REMPLACEZ LES 'XXX' PAR LES D√âNIVEL√âS ===
        mars: [
            {
                weekend: "Samedi 07 & Dimanche 08 Mar",
                idCarteVisu: "R3If8zTbqU",
                t1: { nom: "Parcours #036", km: "79 km", dplus: "D+ 888", lieux: "Nay, St P√©, Rieulhes, Lourdes, S√©gus, Aspin...", lienGPX: "https://www.visugpx.com/download.php?id=R3If8zTbqU" },
                t2: { nom: "Parcours #036", km: "70 km", dplus: "D+ 721", lieux: "Lourdes et retour commun", lienGPX: "https://www.visugpx.com/download.php?id=R3If8zTbqU" }
            },
            {
                weekend: "Samedi 14 & Dimanche 15 Mar",
                idCarteVisu: "S9JpatYuc4",
                t1: { nom: "Parcours #091", km: "77 km", dplus: "D+ 1049", lieux: "Nay, Arros-Nay, Pardies Pietat, Gan...", lienGPX: "https://www.visugpx.com/download.php?id=S9JpatYuc4" },
                t2: { nom: "Parcours #091", km: "70 km", dplus: "D+ 831", lieux: "R√©b√©nacq, Gan et retour commun", lienGPX: "https://www.visugpx.com/download.php?id=S9JpatYuc4" }
            },
            {
                weekend: "Samedi 21 & Dimanche 22 Mar",
                idCarteVisu: "ngpiRawnzC",
                t1: { nom: "Parcours #093", km: "84 km", dplus: "D+ 1020", lieux: "Nay, St Jo, Les Labass√®res, Arros-Nay, Baliros...", lienGPX: "https://www.visugpx.com/download.php?id=ngpiRawnzC" },
                t2: { nom: "Parcours #093", km: "75 km", dplus: "D+ 800", lieux: "Asson et Nay", lienGPX: "https://www.visugpx.com/download.php?id=ngpiRawnzC" }
            },
            {
                weekend: "Samedi 28 & Dimanche 29 Mar",
                idCarteVisu: "lFcq3wEfLm",
                t1: { nom: "Parcours #070", km: "91 km", dplus: "D+ 1112", lieux: "Nay, Arros-Nay, Direction les Pindats...", lienGPX: "https://www.visugpx.com/download.php?id=lFcq3wEfLm" },
                t2: { nom: "Parcours #070", km: "68 km", dplus: "D+ 929", lieux: "Herrere, Buzy, Arudy et retour commun", lienGPX: "https://www.visugpx.com/download.php?id=lFcq3wEfLm" }
            }
        ],

        avril: [], mai: [], juin: [],
        juillet: [], aout: [], septembre: [], octobre: [], novembre: [], decembre: []
    };

    // ===========================================
    // MOTEUR DU SITE
    // ===========================================

    fetch('https://api.open-meteo.com/v1/forecast?latitude=43.18&longitude=-0.26&current_weather=true')
    .then(r => r.json())
    .then(d => {
        const w = d.current_weather;
        document.getElementById('w-text').textContent = Math.round(w.temperature) + "¬∞C ‚Ä¢ Vent: " + Math.round(w.windspeed) + " km/h";
    })
    .catch(() => { document.getElementById('w-text').textContent = "M√©t√©o indisponible"; });

    window.afficherProgramme = function(data) {
        const container = document.getElementById('liste-parcours');
        container.innerHTML = ""; 

        if (!data || data.length === 0) {
            container.innerHTML = "<div class='empty-msg'>Le programme de ce mois n'est pas encore disponible.</div>";
            return;
        }

        data.forEach(item => {
            const linkMap = `https://www.visugpx.com/${item.idCarteVisu}?iframe&maponly`;

            const html = `
            <div class="borne-card">
                <div class="borne-header">${item.weekend}</div>
                <div class="horaires-bandeau">D√©parts : Samedi 13h30 & Dimanche 09h00</div>
                
                <div class="map-section">
                    <button class="btn-map-large" onclick="openMap('${linkMap}')">üó∫Ô∏è VOIR LA CARTE</button>
                </div>

                <div class="circuit-row">
                    <div class="infos-line">
                        <div><span class="tag tag-t1">T1</span> <b style="font-size:1.1rem">${item.t1.km}</b></div>
                        <span class="denivele">‚õ∞Ô∏è ${item.t1.dplus}</span>
                    </div>
                    <div class="nom-parcours">${item.t1.nom}</div>
                    <div class="lieux">üìç ${item.t1.lieux}</div>
                    <a href="${item.t1.lienGPX}" class="btn-gpx btn-gpx-t1" target="_blank">üì• T√âL√âCHARGER GPX T1</a>
                </div>

                <div class="circuit-row">
                    <div class="infos-line">
                        <div><span class="tag tag-t2">T2</span> <b style="font-size:1.1rem">${item.t2.km}</b></div>
                        <span class="denivele">‚õ∞Ô∏è ${item.t2.dplus}</span>
                    </div>
                    <div class="nom-parcours">${item.t2.nom}</div>
                    <div class="lieux">üìç ${item.t2.lieux}</div>
                    <a href="${item.t2.lienGPX}" class="btn-gpx btn-gpx-t2" target="_blank">üì• T√âL√âCHARGER GPX T2</a>
                </div>
            </div>`;
            container.innerHTML += html;
        });
    }

    window.chargerMois = function(mois) {
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        const btnActif = document.getElementById('btn-' + mois);
        if(btnActif) btnActif.classList.add('active');

        afficherProgramme(programmeAnnuel[mois]);
    }

    // Au d√©marrage : Charger Mars par d√©faut
    chargerMois('mars');

    const modal = document.getElementById('map-modal');
    const modalFrame = document.getElementById('modal-frame');

    window.openMap = function(src) {
        modal.style.display = "flex";
        modalFrame.src = src;
        document.body.style.overflow = "hidden";
    }

    window.closeMap = function() {
        modal.style.display = "none";
        modalFrame.src = "";
        document.body.style.overflow = "auto";
    }

} catch (error) {
    document.getElementById('error-log').textContent = "Erreur de code : " + error.message;
}
</script>

</body>
</html>
